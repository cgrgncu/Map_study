%**************************************************************************
%   Name: SRTM15plus_Taiwan_XYZ_to_mat_v20220512a.m
%   Copyright:  
%   Author: HsiupoYeh 
%   Version: v20220512a
%   Description:自「https://www.ngdc.noaa.gov/mgg/global/」下載的「ETOPO1_Bed_g_geotiff.tif」中萃取出台灣範圍內的資料。
%       水平解析度:1-arc-minutes (~1.8 kilometers)，單位[度]，原點正向依照經緯度座標；
%       高程解析度:1公尺，單位公尺，冰層下的基岩表面為原點，向上為正。
%       過程中順便展示地形圖，以利確認資料範圍。
%   需求檔案:       
%       ETOPO1_Bed_g_geotiff.tiff(下載自https://www.ngdc.noaa.gov/mgg/global/)，
%       該檔案必須放置於工作目錄下的資料夾「ETOPO1_GeoTiff」中。
%**************************************************************************
    clear;clc;close all
    %--
    % 下載台灣附近XYZ檔，因為是Cell註冊模式，資料點不會剛好在經緯度上。
    % 使用curl程式下載檔案(效率較佳)
    %--
    if ~(exist('temp','dir')==7)
        mkdir('temp')
    end
    %--    
    % 外部程式 = curl.exe
    tic
    system('curl.exe  "https://topex.ucsd.edu/cgi-bin/get_srtm15.cgi?west=119&east=123&south=21&north=26" "-o" "temp/SRTM15plus_Taiwan_DEM.xyz"');
    toc
    % % Total    % Received % Xferd  Average Speed   Time    Time     Time  Current  Dload  Upload   Total   Spent    Left  Speed 
    % 
    %   0     0    0     0    0     0      0      0 --:--:-- --:--:-- --:--:--     0
    %   0     0    0     0    0     0      0      0 --:--:-- --:--:-- --:--:--     0
    % 100     1    0     1    0     0      0      0 --:--:--  0:00:01 --:--:--     0
    % 100     1    0     1    0     0      0      0 --:--:--  0:00:02 --:--:--     0
    % 100     1    0     1    0     0      0      0 --:--:--  0:00:03 --:--:--     0
    % 100     1    0     1    0     0      0      0 --:--:--  0:00:04 --:--:--     0
    % 100 16001    0 16001    0     0   3108      0 --:--:--  0:00:05 --:--:--  3197
    % 100  656k    0  656k    0     0   106k      0 --:--:--  0:00:06 --:--:--  146k
    % 100 3046k    0 3046k    0     0   429k      0 --:--:--  0:00:07 --:--:--  686k
    % 100 3812k    0 3812k    0     0   470k      0 --:--:--  0:00:08 --:--:--  857k
    % 100 4375k    0 4375k    0     0   480k      0 --:--:--  0:00:09 --:--:--  981k
    % 100 4820k    0 4820k    0     0   477k      0 --:--:--  0:00:10 --:--:--  970k
    % 100 5281k    0 5281k    0     0   475k      0 --:--:--  0:00:11 --:--:--  931k
    % 100 5703k    0 5703k    0     0   470k      0 --:--:--  0:00:12 --:--:--  528k
    % 100 6164k    0 6164k    0     0   470k      0 --:--:--  0:00:13 --:--:--  470k
    % 100 6562k    0 6562k    0     0   465k      0 --:--:--  0:00:14 --:--:--  437k
    % 100 6859k    0 6859k    0     0   453k      0 --:--:--  0:00:15 --:--:--  406k
    % 100 7156k    0 7156k    0     0   444k      0 --:--:--  0:00:16 --:--:--  375k
    % 100 7406k    0 7406k    0     0   432k      0 --:--:--  0:00:17 --:--:--  340k
    % 100 7671k    0 7671k    0     0   423k      0 --:--:--  0:00:18 --:--:--  300k
    % 100 7945k    0 7945k    0     0   415k      0 --:--:--  0:00:19 --:--:--  276k
    % 100 8203k    0 8203k    0     0   406k      0 --:--:--  0:00:20 --:--:--  264k
    % 100 8468k    0 8468k    0     0   400k      0 --:--:--  0:00:21 --:--:--  261k
    % 100 8710k    0 8710k    0     0   394k      0 --:--:--  0:00:22 --:--:--  262k
    % 100 8976k    0 8976k    0     0   387k      0 --:--:--  0:00:23 --:--:--  257k
    % 100 9250k    0 9250k    0     0   383k      0 --:--:--  0:00:24 --:--:--  259k
    % 100 9585k    0 9585k    0     0   381k      0 --:--:--  0:00:25 --:--:--  281k
    % 100 9960k    0 9960k    0     0   380k      0 --:--:--  0:00:26 --:--:--  295k
    % 100 10.0M    0 10.0M    0     0   379k      0 --:--:--  0:00:27 --:--:--  317k
    % 100 10.4M    0 10.4M    0     0   380k      0 --:--:--  0:00:28 --:--:--  347k
    % 100 10.7M    0 10.7M    0     0   378k      0 --:--:--  0:00:29 --:--:--  356k
    % 100 11.0M    0 11.0M    0     0   374k      0 --:--:--  0:00:30 --:--:--  339k
    % 100 11.3M    0 11.3M    0     0   372k      0 --:--:--  0:00:31 --:--:--  330k
    % 100 11.6M    0 11.6M    0     0   371k      0 --:--:--  0:00:32 --:--:--  326k
    % 100 11.9M    0 11.9M    0     0   369k      0 --:--:--  0:00:33 --:--:--  312k
    % 100 12.2M    0 12.2M    0     0   369k      0 --:--:--  0:00:34 --:--:--  314k
    % 100 12.6M    0 12.6M    0     0   367k      0 --:--:--  0:00:35 --:--:--  323k
    % 100 12.8M    0 12.8M    0     0   365k      0 --:--:--  0:00:36 --:--:--  319k
    % 100 13.1M    0 13.1M    0     0   361k      0 --:--:--  0:00:37 --:--:--  297k
    % 100 13.3M    0 13.3M    0     0   360k      0 --:--:--  0:00:38 --:--:--  294k
    % 100 13.6M    0 13.6M    0     0   357k      0 --:--:--  0:00:39 --:--:--  276k
    % 100 13.8M    0 13.8M    0     0   354k      0 --:--:--  0:00:40 --:--:--  264k
    % 100 14.1M    0 14.1M    0     0   353k      0 --:--:--  0:00:41 --:--:--  271k
    % 100 14.4M    0 14.4M    0     0   351k      0 --:--:--  0:00:42 --:--:--  279k
    % 100 14.8M    0 14.8M    0     0   351k      0 --:--:--  0:00:43 --:--:--  288k
    % 100 15.1M    0 15.1M    0     0   352k      0 --:--:--  0:00:44 --:--:--  316k
    % 100 15.5M    0 15.5M    0     0   353k      0 --:--:--  0:00:45 --:--:--  346k
    % 100 15.8M    0 15.8M    0     0   352k      0 --:--:--  0:00:46 --:--:--  344k
    % 100 16.1M    0 16.1M    0     0   352k      0 --:--:--  0:00:47 --:--:--  353k
    % 100 16.5M    0 16.5M    0     0   351k      0 --:--:--  0:00:48 --:--:--  349k
    % 100 16.8M    0 16.8M    0     0   351k      0 --:--:--  0:00:49 --:--:--  339k
    % 100 17.2M    0 17.2M    0     0   352k      0 --:--:--  0:00:50 --:--:--  343k
    % 100 17.7M    0 17.7M    0     0   354k      0 --:--:--  0:00:51 --:--:--  371k
    % 100 18.0M    0 18.0M    0     0   355k      0 --:--:--  0:00:52 --:--:--  385k
    % 100 18.3M    0 18.3M    0     0   354k      0 --:--:--  0:00:53 --:--:--  386k
    % 100 18.6M    0 18.6M    0     0   352k      0 --:--:--  0:00:54 --:--:--  365k
    % 100 18.9M    0 18.9M    0     0   351k      0 --:--:--  0:00:55 --:--:--  336k
    % 100 19.2M    0 19.2M    0     0   350k      0 --:--:--  0:00:56 --:--:--  314k
    % 100 19.5M    0 19.5M    0     0   350k      0 --:--:--  0:00:57 --:--:--  298k
    % 100 19.8M    0 19.8M    0     0   350k      0 --:--:--  0:00:58 --:--:--  303k
    % 100 20.1M    0 20.1M    0     0   349k      0 --:--:--  0:00:59 --:--:--  312k
    % 100 20.4M    0 20.4M    0     0   348k      0 --:--:--  0:01:00 --:--:--  321k
    % 100 20.7M    0 20.7M    0     0   348k      0 --:--:--  0:01:01 --:--:--  315k
    % 100 20.9M    0 20.9M    0     0   346k      0 --:--:--  0:01:02 --:--:--  297k
    % 100 21.1M    0 21.1M    0     0   343k      0 --:--:--  0:01:03 --:--:--  263k
    % 100 21.3M    0 21.3M    0     0   341k      0 --:--:--  0:01:04 --:--:--  248k
    % 100 21.6M    0 21.6M    0     0   340k      0 --:--:--  0:01:05 --:--:--  235k
    % 100 21.8M    0 21.8M    0     0   338k      0 --:--:--  0:01:06 --:--:--  224k
    % 100 22.0M    0 22.0M    0     0   336k      0 --:--:--  0:01:07 --:--:--  220k
    % 100 22.2M    0 22.2M    0     0   334k      0 --:--:--  0:01:08 --:--:--  224k
    % 100 22.4M    0 22.4M    0     0   333k      0 --:--:--  0:01:09 --:--:--  226k
    % 100 22.7M    0 22.7M    0     0   331k      0 --:--:--  0:01:10 --:--:--  217k
    % 100 22.9M    0 22.9M    0     0   330k      0 --:--:--  0:01:11 --:--:--  221k
    % 100 23.2M    0 23.2M    0     0   329k      0 --:--:--  0:01:12 --:--:--  233k
    % 100 23.4M    0 23.4M    0     0   328k      0 --:--:--  0:01:13 --:--:--  249k
    % 100 23.7M    0 23.7M    0     0   328k      0 --:--:--  0:01:14 --:--:--  258k
    % 100 24.0M    0 24.0M    0     0   327k      0 --:--:--  0:01:15 --:--:--  271k
    % 100 24.3M    0 24.3M    0     0   327k      0 --:--:--  0:01:16 --:--:--  282k
    % 100 24.5M    0 24.5M    0     0   326k      0 --:--:--  0:01:17 --:--:--  281k
    % 100 24.8M    0 24.8M    0     0   326k      0 --:--:--  0:01:18 --:--:--  284k
    % 100 25.1M    0 25.1M    0     0   325k      0 --:--:--  0:01:19 --:--:--  292k
    % 100 25.4M    0 25.4M    0     0   325k      0 --:--:--  0:01:20 --:--:--  303k
    % 100 25.8M    0 25.8M    0     0   325k      0 --:--:--  0:01:21 --:--:--  305k
    % 100 26.1M    0 26.1M    0     0   325k      0 --:--:--  0:01:22 --:--:--  319k
    % 100 26.4M    0 26.4M    0     0   325k      0 --:--:--  0:01:23 --:--:--  321k
    % 100 26.6M    0 26.6M    0     0   325k      0 --:--:--  0:01:24 --:--:--  312k
    % 100 26.9M    0 26.9M    0     0   324k      0 --:--:--  0:01:25 --:--:--  303k
    % 100 27.2M    0 27.2M    0     0   324k      0 --:--:--  0:01:26 --:--:--  298k
    % 100 27.5M    0 27.5M    0     0   324k      0 --:--:--  0:01:27 --:--:--  291k
    % 100 27.8M    0 27.8M    0     0   323k      0 --:--:--  0:01:28 --:--:--  292k
    % 100 28.1M    0 28.1M    0     0   324k      0 --:--:--  0:01:29 --:--:--  307k
    % 100 28.5M    0 28.5M    0     0   324k      0 --:--:--  0:01:30 --:--:--  322k
    % 100 28.8M    0 28.8M    0     0   324k      0 --:--:--  0:01:31 --:--:--  321k
    % 100 29.1M    0 29.1M    0     0   324k      0 --:--:--  0:01:32 --:--:--  331k
    % 100 29.4M    0 29.4M    0     0   324k      0 --:--:--  0:01:33 --:--:--  331k
    % 100 29.8M    0 29.8M    0     0   324k      0 --:--:--  0:01:34 --:--:--  332k
    % 100 30.1M    0 30.1M    0     0   324k      0 --:--:--  0:01:35 --:--:--  334k
    % 100 30.5M    0 30.5M    0     0   325k      0 --:--:--  0:01:36 --:--:--  348k
    % 100 30.9M    0 30.9M    0     0   326k      0 --:--:--  0:01:37 --:--:--  363k
    % 100 31.4M    0 31.4M    0     0   327k      0 --:--:--  0:01:38 --:--:--  392k
    % 100 31.8M    0 31.8M    0     0   329k      0 --:--:--  0:01:39 --:--:--  413k
    % 100 32.3M    0 32.3M    0     0   330k      0 --:--:--  0:01:40 --:--:--  443k
    % 100 32.8M    0 32.8M    0     0   332k      0 --:--:--  0:01:41 --:--:--  471k
    % 100 33.4M    0 33.4M    0     0   334k      0 --:--:--  0:01:42 --:--:--  500k
    % 100 33.9M    0 33.9M    0     0   336k      0 --:--:--  0:01:43 --:--:--  509k
    % 100 34.3M    0 34.3M    0     0   338k      0 --:--:--  0:01:44 --:--:--  522k
    % 100 34.9M    0 34.9M    0     0   340k      0 --:--:--  0:01:45 --:--:--  525k
    % 100 35.4M    0 35.4M    0     0   342k      0 --:--:--  0:01:46 --:--:--  532k
    % 100 35.9M    0 35.9M    0     0   343k      0 --:--:--  0:01:47 --:--:--  516k
    % 100 36.4M    0 36.4M    0     0   345k      0 --:--:--  0:01:48 --:--:--  521k
    % 100 36.9M    0 36.9M    0     0   346k      0 --:--:--  0:01:49 --:--:--  530k
    % 100 37.5M    0 37.5M    0     0   348k      0 --:--:--  0:01:50 --:--:--  533k
    % 100 38.0M    0 38.0M    0     0   350k      0 --:--:--  0:01:51 --:--:--  529k
    % 100 38.5M    0 38.5M    0     0   352k      0 --:--:--  0:01:52 --:--:--  539k
    % 100 39.0M    0 39.0M    0     0   353k      0 --:--:--  0:01:53 --:--:--  546k
    % 100 39.5M    0 39.5M    0     0   355k      0 --:--:--  0:01:53 --:--:--  549k 
    % Elapsed time is 114.063093 seconds.
    %--
    % 讀取台灣附近XYZ檔，因為是Cell註冊模式，資料點不會剛好在經緯度上。
    tic
    SRTM15plus_Taiwan_DEM.Data.XYZ=load('temp/SRTM15plus_Taiwan_DEM.xyz');
    toc
    % Elapsed time is 4.879818 seconds.
    %--    
    SRTM15plus_Taiwan_DEM.Data.XYZ_Header={'Longitude[degrees]','Latitude[degrees]','Elevation[m]'};
    %--
    % 補充資訊
    SRTM15plus_Taiwan_DEM.Description='來源:自「https://topex.ucsd.edu/cgi-bin/get_srtm15.cgi?west=119&east=123&south=21&north=26」。水平解析度:15-arc-seconds (~450 meters)，單位[度]，原點正向依照經緯度座標；高程解析度:浮點數，單位公尺，高程原點不確定推測是海平面，向上為正。';
    SRTM15plus_Taiwan_DEM.Version='20220512a';
    SRTM15plus_Taiwan_DEM.Editor='HsiupoYeh';
    % 存檔
    if ~(exist('Output','dir')==7)
        mkdir('Output')
    end
    save('Output\SRTM15plus_Taiwan_DEM.mat','SRTM15plus_Taiwan_DEM','-v7.3')    
    %--
    % 刪除暫存的xyz檔案
    [stat, mess]=rmdir('temp','s');
    %--